<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<script>
function goback() {
	window.history.back();
}

function parse_json() {
try {
	var json = JSON.parse({{parsed_json|tojson}});
	var jsonpretty = JSON.stringify(json, undefined, 2);
	var labelpretty = document.getElementById("jsonpretty");
	labelpretty.innerHTML = jsonpretty;
	labelpretty.hidden = false;
}catch (err) {
}
}

function get_table() {
	request = new XMLHttpRequest();
	request.open("POST", "/getwhatistable", true);
	request.onreadystatechange = display_table;
	request.send(null);

}

function display_table() {
	if (request.readyState == 4 && request.status == 200) {
	        var labelpretty = document.getElementById("jsonpretty");
	        labelpretty.innerHTML = request.responseText;
            unparsed_json = JSON.parse(request.responseText);
            var table = document.getElementById("whatisTable");

            for (var i = 0; i < unparsed_json.length; i++) {
                var row = table.insertRow(i+1);
                var protocal = row.insertCell(0);
                protocal.innerHTML = unparsed_json[i].protocal;

                var desc = row.insertCell(1);
                desc.innerHTML = unparsed_json[i].Description;

                var port = row.insertCell(2);
                port.innerHTML = unparsed_json[i]["Port Number"];

                var notes = row.insertCell(3);
                notes.innerHTML = unparsed_json[i]["Assignment Notes"];

                var service = row.insertCell(4);
                service.innerHTML = unparsed_json[i]["Service Name"];
            }


	}

}

window.onload = function(){
parse_json();
get_table();

};

</script>

<body>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand">Giant</a>
    </div>
    <ul class="nav navbar-nav">
      <li><a href="home.html">Home</a></li>
      <li><a href="displayip.html">Ip Info</a></li>
      <li><a href="displaydomain.html">Who Is</a></li>
      <li class="active"><a href="displaywhatis.html">What Is</a></li>
	  <li><a href="displayevent.html">Event</a></li>
    </ul>
  </div>
</nav>

<form action="/whatis" method="post">
	<div class="container">
		<h1>What Is</h1>
		<p>Enter port number: <p>
		<input type="text" name="number"><br>
        <p>Enter protocol (optional): </p>
        <input type="text" name="proto"><br>
		<button class="btn btn-default" type="submit">Submit</button>
	</div>
</form>

<pre hidden='hidden' id = "jsonpretty"></pre>

<div class="table-responsive">
<table id="whatisTable" class="table">
    <tr>
        <th>Transport Protocal</th>
        <th>Description</th>
        <th>Port Number</th>
        <th>Assignment Notes</th>
        <th>Service Name</th>
    </tr>
</table>
    </div>

 
</body>